<p>iText è sicuramente la libreria più diffusa e completa per l’elaborazione di file pdf, consiglio vivamente di darci un occhiata prima di valutare altri framework o reinventare l’acqua calda.</p>

<p>Ma veniamo al sodo,vi riporto sotto il codice di una classe che permette di fondere una serie di PDF insieme, di fatto si tratta di concatenare una serie di file e crearne uno risultante dal processo.</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcatDocumentCommand</span> <span class="o">{</span>


    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">ConcatDocumentCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>


    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">outputFilename</span><span class="o">;</span>


    <span class="kd">public</span> <span class="nf">ConcatDocumentCommand</span><span class="o">(</span><span class="n">String</span> <span class="n">outputFilename</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">outputFilename</span> <span class="o">=</span> <span class="n">outputFilename</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">String</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Document</span><span class="o">();</span>
            <span class="n">PdfCopy</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PdfCopy</span><span class="o">(</span><span class="n">document</span><span class="o">,</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">outputFilename</span><span class="o">));</span>
            <span class="n">document</span><span class="o">.</span><span class="na">open</span><span class="o">();</span>
            <span class="n">PdfReader</span> <span class="n">reader</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">pagesNumber</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">file</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PdfReader</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
                <span class="n">pagesNumber</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">getNumberOfPages</span><span class="o">();</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">page</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">page</span> <span class="o">&lt;</span> <span class="n">pagesNumber</span><span class="o">;)</span> <span class="o">{</span>
                    <span class="n">copy</span><span class="o">.</span><span class="na">addPage</span><span class="o">(</span><span class="n">copy</span><span class="o">.</span><span class="na">getImportedPage</span><span class="o">(</span><span class="n">reader</span><span class="o">,</span> <span class="o">++</span><span class="n">page</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">document</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">copy</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">DocumentException</span> <span class="o">|</span> <span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">SEVERE</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ConcatDocumentCommand</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcatDocumentCommand</span><span class="o">(</span><span class="s">&quot;/test/test1_concat_test2.pdf&quot;</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;/tmp/test1.pdf&quot;</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;/tmp/test2.pdf&quot;</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>La versione utilizzata del linguaggio Java è la 7, non stupitevi quindi del
multiple catch ne della diamond notation. Peccato che nella versione che utilizzo per questo esempio gli oggetti iText non permettano anche l’uso del <code>try</code> with resources.</p>

<p>Il codice è piuttosto eloquente è si commenta da solo, il vero lavoro lo fa l’oggetto <code>PdfCopy</code> nel blocco</p>

<div class="highlight"><pre><code class="java"><span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PdfReader</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
<span class="n">pagesNumber</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">getNumberOfPages</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">page</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">page</span> <span class="o">&lt;</span> <span class="n">pagesNumber</span><span class="o">;)</span> <span class="o">{</span>
     <span class="n">copy</span><span class="o">.</span><span class="na">addPage</span><span class="o">(</span><span class="n">copy</span><span class="o">.</span><span class="na">getImportedPage</span><span class="o">(</span><span class="n">reader</span><span class="o">,</span> <span class="o">++</span><span class="n">page</span><span class="o">));</span>
<span class="o">}</span></code></pre></div>

<p>infatti dal <code>reader</code> vengono estratte le pagine del documento, una per una e poi aggiunte all’oggetto <code>copy</code>.</p>
